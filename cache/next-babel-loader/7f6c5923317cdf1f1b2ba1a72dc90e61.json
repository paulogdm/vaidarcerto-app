{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { cleanDigits } from '../../../modules/utils/strings';\nimport { database, getServerTimestamp } from '../../../modules/firebase/services';\n\nvar create = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(postBody) {\n    var collectionRef, hasWhatsApp, whatsApp, postData;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!(typeof postBody === \"object\" && postBody['title'])) {\n              _context.next = 9;\n              break;\n            }\n\n            collectionRef = database.collection('customers');\n            hasWhatsApp = Boolean(!['', null, undefined, 'undefined'].includes(postBody.whatsApp));\n            whatsApp = hasWhatsApp ? cleanDigits(postBody.whatsApp) : null;\n            postBody.hasWhatsApp = hasWhatsApp;\n            postBody.whatsApp = whatsApp;\n            postBody.status = 'pending';\n            postData = _objectSpread(_objectSpread({}, postBody), {}, {\n              updatedAt: getServerTimestamp()\n            });\n            return _context.abrupt(\"return\", collectionRef.add(postData).then(function (docRef) {\n              var id = docRef.id;\n              var message = 'Doc successfully created!';\n              console.log(message, id);\n              return {\n                message: message\n              };\n            }).catch(function (err) {\n              var error = {};\n              error.message = 'Error creating the Ad.';\n              console.error(error, err);\n\n              if (err.code && err.code === 'permission-denied') {\n                error.message = 'Database create permission denied!';\n                return {\n                  error: error\n                };\n              }\n\n              return {\n                error: error\n              };\n            }));\n\n          case 9:\n            return _context.abrupt(\"return\", {\n              notObject: true\n            });\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function create(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nexport default create;","map":null,"metadata":{},"sourceType":"module"}