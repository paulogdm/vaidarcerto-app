{"ast":null,"code":"import { database, parseQuerySnapshot } from '~/modules/firebase/services';\nimport { itHasValue } from '~/modules/utils/objects';\n\nconst composeQuery = (query = {}) => {\n  const customersRef = database.collection('customers'); // fetch ONLY published records.\n\n  const customersQuery = customersRef.where('status', '==', 'published');\n  const props = {\n    customersQuery\n  };\n\n  if (itHasValue(query.category)) {\n    props.customersQuery = customersQuery.where('category', 'array-contains', query.category);\n  }\n\n  const orderedQuery = props.customersQuery.orderBy('title');\n  return orderedQuery;\n};\n\nconst getCustomers = async query => {\n  const props = {\n    customers: []\n  };\n  const customersQuery = composeQuery(query);\n  const querySnapshot = await customersQuery.get();\n\n  if (Boolean(querySnapshot.size) && querySnapshot.size > 0) {\n    const customersArray = await parseQuerySnapshot(querySnapshot);\n    props.customers = customersArray;\n  }\n\n  return props.customers;\n};\n\nexport default getCustomers;","map":null,"metadata":{},"sourceType":"module"}